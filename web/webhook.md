# Webhook란

webhook은 웹 서비스의 특정 이벤트 데이터가 변경되었을 때 이벤트 데이터를 보내는 HTTP기반 콜백 함수다.
2007년 Jeff Lindsay가 블로그 포스트(웹에 혁신을 가져오는 웹후크)를 작성하며 처음 사용되었다. HTTP를 통해 애플리케이션 간 데이터를 자동 전송하는 경량화 이벤트 기반 통신이기 때문에 API간 통신을 자동화하고 워크플로우를 활성화 하는데 사용할 수 있다.

webhook는 통신 책임을 클라이언트가 아닌 서버에 부과하여 리버스API 혹은 푸시API라고 불리지만 실제로 API는 아니며 서로 연동되어 동작한다. 즉 webhook를 사용하려면 애플리케이션에 API가 존재해야 한다.

대부분의 webhook지원 애플리케이션은 페이로드\*가 전송되기 전에 클라이언트와 서버를 모두 검증하는 mTLS(mutual Transport Layer Security) 인증으로 보호되는 경우가 많다. 그리고 전송된 데이터를 비공개로 유지되도록 클라이언트 애플리케이션이 webhook URL에 SSL 암호화를 사용하는 것이 일반적인 방식이다.

\*페이로드: 이벤트 데이터

# webhook 전달과정

1. 클라이언트가 서버에게 웹훅을 받을 유니크한 URL을 제공하고, 받고 싶은 이벤트를 등록한다.
2. 등록한 이벤트가 발생하면 클라이언트는 제공한 URL로 이벤트 데이터를 받는다

# API 폴링과 웹훅의 차이점

API 폴링

- 클라이언트가 서버 API를 호출해서 이벤트가 발생하기 전까지 주기적으로 API를 호출하기 때문에 애플리케이션에 소요되는 리소스가 크다.
- 일반적으로 60초에서 120초로 API 주기를 설정하여도 실시간으로 이벤트 데이터를 받기가 어렵다

webhook

- 한번 설정하면 클라이언트가 추가 요청을 보내지 않아도 돼서 클라이언트 애플리케이션에 소요되는 리소스가 절감된다
- 서버에서 이벤트 발생시 페이로드를 보내주기 때문에 실시간으로 데이터를 받을 수 있다
- 가벼운 HTTP 패턴을 사용하기 때문에 webhook를 지원하는 애플리케이션의 경우 대부분 설정이 간단하다

# 참고

- [토스페이먼츠 개발자센터 용어사전 - webhook](https://docs.tosspayments.com/resources/glossary/webhook)
- [Redhat - 토픽 - 자동화와 관리 - 웹후크란?](https://www.redhat.com/ko/topics/automation/what-is-a-webhook)
